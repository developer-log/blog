---
title: "Event Loop Ð² Ð´ÐµÑ‚Ð°Ð»ÑÑ…"
tags:
  - javascript
  - frontend
date: 12 Sep 2023
references:
  - name: "Event loop under the hood"
    url: https://dev.to/_staticvoid/node-js-under-the-hood-3-deep-dive-into-the-event-loop-135d
  - name: "Habr: Ð‘Ð°Ð·Ð¾Ð²Ð¾Ðµ Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð° Event Loop"
    url: https://habr.com/ru/articles/680846/
  - name: "Event loop explainer"
    url: https://github.com/atotic/event-loop
  - name: "Event loop: Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¸ Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð¸"
    url: https://frontend-blog-tau.vercel.app/event-loop
---

Ð’ Ð´Ð°Ð½Ð½Ð¾Ð¹ ÑÑ‚Ð°Ñ‚ÑŒÐµ Ð¿Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ð¼ Ð¾ Ñ‚Ð¾Ð¼, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Event Loop Ð²Ð¾Ð¾Ð±Ñ‰Ðµ Ð±Ñ‹Ð» ÑÐ¾Ð·Ð´Ð°Ð½, ÐºÐ°Ðº Ñ Ð½Ð¸Ð¼ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ
Ð¸ Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð¿Ñ€Ð¾ Ð½ÐµÐ³Ð¾ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ Ð½Ð° ÑÐ¾Ð±ÐµÑÐ°Ñ….

JS Ð±Ñ‹Ð» ÑÐ¿Ñ€Ð¾ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½ ÐºÐ°Ðº Ð¾Ð´Ð½Ð¾Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ ÑÐ·Ñ‹Ðº Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ. Ð­Ñ‚Ð¾ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚, Ñ‡Ñ‚Ð¾ Ð¾Ð½ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾
Ð¾Ð´Ð½Ñƒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾. Ð¢ÐµÐ¼ Ð½Ðµ Ð¼ÐµÐ½ÐµÐµ Ñƒ JavaScript ÐµÑÑ‚ÑŒ Ñ‚Ð°ÐºÐ¾Ð¹ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ ÐºÐ°Ðº Event Loop, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÐºÐ°Ðº Ñ€Ð°Ð· Ð¸ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚
Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ "Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ" Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸. ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ "Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ" Ð² ÐºÐ°Ð²Ñ‹Ñ‡ÐºÐ°Ñ…? Ð”Ð° Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ JavaScript Ñ‚Ð¾Ð¶Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ Ð¸Ñ… ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾, Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾ÑÑ‚Ð¸ Ð² JavaScript ÐºÐ°Ðº Ñ‚Ð°ÐºÐ¾Ð²Ð¾Ð¹ Ð½ÐµÑ‚.
Ð’Ð¿ÐµÑ€ÐµÐ´ Ð¿Ð¾Ð´ ÐºÐ°Ñ‚, Ð±ÑƒÐ´ÐµÐ¼ Ñ€Ð°Ð·Ð±Ð¸Ñ€Ð°Ñ‚ÑŒÑÑ)

# Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´
Ð¡ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼ ÐºÐ¾Ð´Ð¾Ð¼ Ð²ÑÐµ Ð±Ð¾Ð»ÐµÐµ Ð¸Ð»Ð¸ Ð¼ÐµÐ½ÐµÐµ ÑÑÐ½Ð¾: Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ‚Ð¾Ñ€ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð¿Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ ÐµÐµ Ð¸ Ð²ÑÐµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚.

```js [sync.js]
let acc = 1;
console.log(acc); // 1

acc++;
console.log(acc); // 2

let anotherAcc = acc;
console.log(anotherAcc, acc); // 3 3
```

::ContentSvg{src="./assets/loop.svg" alt="ÐŸÐ¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ Event Loop"}
::

# ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ¾Ð´
Ð¡ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼ ÐºÐ¾Ð´Ð¾Ð¼ Ð²ÑÐµ Ð½ÐµÐ¼Ð½Ð¾Ð¶ÐºÐ¾ ÑÐ»Ð¾Ð¶Ð½ÐµÐµ. Ð Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ð¿Ñ€Ð¸Ð¼ÐµÑ€:

```js [async.js]
let acc = 1;
console.log("Call 1:", acc);

acc++;
console.log("Call 2:", acc);

setTimeout(() => {
  acc++;
  console.log("Call 3:", acc);
}, 0);

let anotherAcc = acc;
console.log("Call 4:", anotherAcc, acc);
```

```output
Call 1: 1
Call 2: 2
Call 4: 2 2
Call 3: 3
```

ÐšÐ°Ðº Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ `console.log`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð±Ñ‹Ð» Ð² `setTimeout` Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ-Ñ‚Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»ÑÑ Ð¿Ð¾Ð·Ð¶Ðµ, Ð½Ð¾ Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ñ‚Ð°Ðº ÑÐ»ÑƒÑ‡Ð¸Ð»Ð¾ÑÑŒ?

Ð¢ÑƒÑ‚ Ð² ÑÐ¸Ð»Ñƒ Ð¸ Ð²ÑÑ‚ÑƒÐ¿Ð°ÐµÑ‚ Event Loop. Ð¢Ð°Ðº ÐºÐ°Ðº `setTimeout` ÑÑ‚Ð¾ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ (Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð²Ñ‹ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°, Ð° Ð½Ðµ Ð² JS).

## ÐŸÑ€Ð¾Ñ…Ð¾Ð´Ð¸Ð¼ÑÑ Ð¿Ð¾ ÐºÐ¾Ð´Ñƒ ÐºÐ°Ðº Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ‚Ð¾Ñ€
Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð²ÑÐµ Ð±Ð¾Ð»ÐµÐµ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ð¾. ÐœÑ‹ Ð¾Ð±ÑŠÑÐ²Ð»ÑÐµÐ¼ Ð²ÑÐµ Ð½Ð°ÑˆÐ¸ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¸ Ð¿Ñ€Ð¾Ð´ÐµÐ»Ñ‹Ð²Ð°ÐµÐ¼ Ñ Ð½Ð¸Ð¼Ð¸ ÐºÐ°ÐºÐ¸Ðµ-Ñ‚Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸. Ð’ÑÐµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ ÐºÐ°Ðº Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ‚Ð¾Ñ€ Ð´Ð¾Ð¹Ð´ÐµÑ‚ Ð´Ð¾ Ð½Ð¸Ñ…:

::ContentSvg{src="./assets/event-loop-1.svg" alt="ÐšÐ°Ðº Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹"}
::

Ð”Ñ€ÑƒÐ³Ð¾Ðµ Ð´ÐµÐ»Ð¾ Ð¾Ð±ÑÑ‚Ð¾Ð¸Ñ‚ Ñ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð¾Ð¼, Ð²Ñ€ÐµÐ¼Ñ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð±ÑƒÐ´ÐµÑ‚ ÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒÑÑ Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ ÐºÐ°Ðº Ð±Ñ‹ "Ð¿Ñ€Ð¾Ð¿Ð°Ð´ÐµÑ‚" Ð¸Ð· Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸.
Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð¿Ð¾Ð¿Ð°Ð» Ð² Event Loop, Ð³Ð´Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð¶Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾ÐºÑƒÐ´Ð° Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð½Ðµ Ð¿Ñ€Ð¸ÑˆÐ»ÐµÑ‚ ÑÐ¸Ð³Ð½Ð°Ð», Ð¾ Ñ‚Ð¾Ð¼ Ñ‡Ñ‚Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð´Ð»Ñ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ð° Ð²Ñ‹ÑˆÐ»Ð¾ Ð¸ ÐºÐ¾Ð»Ð»Ð±ÑÐº Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð° Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ.

::ContentSvg{src="./assets/event-loop-2.svg" alt="Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð¸ÑÑ‡ÐµÐ·Ð°ÐµÑ‚ Ð¸Ð· Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ðŸ¥¸"}
::

Ð¢ÐµÐ¿ÐµÑ€ÑŒ ÑÐ°Ð¼Ð¾Ðµ Ð½ÐµÐ¾Ñ‡ÐµÐ²Ð¸Ð´Ð½Ð¾Ðµ: Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»ÑÑ, Ð° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¼Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÐ¼ Ð²ÑÐµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ ÐµÑ‰Ðµ Ð½Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð°ÑÑŒ, Event Loop Ð±ÑƒÐ´ÐµÑ‚ Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð²ÑÐµ Ñ‡Ñ‚Ð¾ Ð² Ð½ÐµÐ¼ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ÑÑ,
Ð¿Ð¾ÐºÑƒÐ´Ð° Ñƒ Ð½Ð°Ñ Ð½Ðµ Ð¾Ñ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑÑ Call Stack. **Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ñ‚Ð¾Ð³Ð¾ ÐºÐ°Ðº Ð²ÑÐµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð¸ÑÑŒ** Event Loop Ð¾Ñ‚Ð´Ð°ÑÑ‚ Ð½Ð°Ð¼ Ð½Ð°Ñˆ Ñ‚Ð°Ð¹Ð¼ÐµÑ€, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ñ‹ ÑÐ¼Ð¾Ð¶ÐµÐ¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ:

::ContentSvg{src="./assets/event-loop-3.svg" alt="Ð’ÑÐµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð·Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð»Ð¸ÑÑŒ, Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð¾Ñ‚Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð» Ð¸ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ"}
::

# Ð›ÐµÐ·ÐµÐ¼ Ð² Ð´ÐµÐ±Ñ€Ð¸

ÐšÐ°Ðº ÑƒÐ¶Ðµ Ð±Ñ‹Ð»Ð¾ ÑÐºÐ°Ð·Ð°Ð½Ð¾ Ð²Ñ‹ÑˆÐµ Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ‚Ð¾Ñ€ Ð² JavaScript Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ Ð¾Ð´Ð½Ñƒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ Ð·Ð° Ñ€Ð°Ð·, Ð²ÑÐµ Ñ‡Ñ‚Ð¾ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼ Ð¾Ð½ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð² Event Loop.
ÐžÐ´Ð½Ð°ÐºÐ¾, Ð²Ñ‹ Ð½Ð°Ð²ÐµÑ€Ð½Ð¾Ðµ Ð¼Ð¾Ð³Ð»Ð¸ ÑÐ»Ñ‹ÑˆÐ°Ñ‚ÑŒ Ð¾ Ñ‚Ð°ÐºÐ¸Ñ… Ð²ÐµÑ‰Ð°Ñ… ÐºÐ°Ðº "Ð¼Ð°ÐºÑ€Ð¾Ñ‚Ð°ÑÐºÐ¸" Ð¸ "Ð¼Ð¸ÐºÑ€Ð¾Ñ‚Ð°ÑÐºÐ¸".

Ð”ÐµÐ»Ð¾ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Event Loop - ÐµÐ´Ð¸Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ Ð² JavaScript, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾ÑÑ‚ÑŒ (Ñ…Ð¾Ñ‚Ñ Ð¿Ð¾ ÑÑƒÑ‚Ð¸ Ð²ÑÐµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑŽÑ‚ÑÑ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾, Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¾Ñ‡ÐµÐ½ÑŒ Ð±Ñ‹ÑÑ‚Ñ€Ð¾, Ð¾Ð± ÑÑ‚Ð¾Ð¼ Ð´Ð°Ð»ÐµÐµ).
Event Loop ÑÐ²Ð»ÑÐµÑ‚ÑÑ ÑÑ‚ÐµÐºÐ¾Ð¼, Ð³Ð´Ðµ Ñ…Ñ€Ð°Ð½ÑÑ‚ÑÑ Ð²ÑÐµ Ð·Ð°Ð´Ð°Ñ‡Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½Ðµ Ð²Ð¾ÑˆÐ»Ð¸ Ð² ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ Ð¿Ð¾Ñ‚Ð¾Ðº Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ. ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ñ‚Ð¾ÐºÐ° - Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÑŽÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ Ð¸Ð· Event Loop'Ð°.
ÐžÐ´Ð½Ð°ÐºÐ¾ Ñƒ Event Loop'Ð° Ñ‚Ð¾Ð¶Ðµ ÐµÑÑ‚ÑŒ ÑÐ²Ð¾Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°. ÐžÐ½ Ð´ÐµÐ»Ð¸Ñ‚ Ð²ÑÐµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð° Ð¿Ð¾Ð´Ñ‚Ð¸Ð¿Ñ‹:

- ÐœÐ¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð¸
- ÐœÐ°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð¸
- Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð¾Ñ‚Ñ€Ð¸ÑÐ¾Ð²ÐºÐ¸

ÐœÐ°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð°Ð¼Ð¸ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ð²ÑÐµ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸, Ñ‚Ð°ÐºÐ¸Ðµ ÐºÐ°Ðº XmlHTTPRequest, setTimeout Ð¸ Ñ‚Ð°Ðº Ð´Ð°Ð»ÐµÐµ.

Ð’ Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¿Ð¾Ð¿Ð°Ð´Ð°ÑŽÑ‚ Ð² Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð²Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸: `then` Ñƒ Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ¾Ð², Ð° Ñ‚Ð°ÐºÐ¶Ðµ [Intersection Observer](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API).

Ð’ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¾Ñ‚Ñ€Ð¸ÑÐ¾Ð²ÐºÐ¸ Ð¿Ð¾Ð¿Ð°Ð´Ð°ÑŽÑ‚ Ð·Ð°Ð´Ð°Ñ‡Ð¸ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ñ Ð¾Ñ‚Ñ€Ð¸ÑÐ¾Ð²ÐºÐ¾Ð¹ Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹.

Ð•ÑÐ»Ð¸ Ð±Ñ‹ Ð¼Ñ‹ Ð´ÐµÐ»Ð°Ð»Ð¸ ÑÐ²Ð¾Ð¹ Event Loop, Ñ‚Ð¾ Ð¾Ð½ Ð±Ñ‹ Ð²Ñ‹Ð³Ð»ÑÐ´ÐµÐ» ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼:

```ts [event-loop.ts]
// Ð—Ð°Ð´Ð°Ñ‡Ð°
interface Task {
  execute: () => {},
}

// Ð Ð°Ð·Ð½Ñ‹Ðµ Ñ‚Ð¸Ð¿Ñ‹ Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡
interface MacroTasks {
  parser: Task[];
  resources: Task[];
  domManipulation: Task[];
  events: Task[];
  callbacks: Task[];
}

// Ð¢Ð¸Ð¿Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ ÑÐ°Ð¼Ð¾Ð³Ð¾ Event Loop'Ð°
interface EventLoop {
  macrotasks: MacroTasks;
  microtasks: Task[];
  nextMacrotask: () => Task | null;
  needRender: () => boolean;
  render: () => void;
}

// ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ñ‚Ð¾Ð³Ð¾ ÐµÑÑ‚ÑŒ Ð»Ð¸ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð² callstack
let isCallStackEmpty = false;

const eventLoop: EventLoop = {
  macrotasks: {
    parser: [], // ÐŸÐ°Ñ€ÑÐµÑ€Ñ‹ HTML, CSS, A11y Tree
    resources: [], // ÐŸÐ¾Ð´Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð²
    domManipulation: [], // ÐœÐ°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ð¸ Ñ DOM
    events: [], // Ð˜Ð²ÐµÐ½Ñ‚Ñ‹ UI
    callbacks: [], // ÐšÐ¾Ð»Ð»Ð±ÑÐºÐ¸ Ð¸Ð· setTimeout Ð¸ Ñ‚Ð°Ðº Ð´Ð°Ð»ÐµÐµ
  },

  microtasks: [],

  // ÐžÑ‚Ð´Ð°ÐµÑ‚ Ð½Ð°Ð¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÑƒÑŽ Ð·Ð°Ð´Ð°Ñ‡Ñƒ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ° Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡
  nextMacrotask() {
    for (const macrotaskSection in this.macrotasks) {
      const queue = this.macrotasks[macrotaskSection as keyof typeof this.macrotasks];

      if (queue.length) {
        return queue.shift() ?? null;
      }
    }
    return null;
  },

  needRender: () => false,
  render() {}
}

// Event loop Ð½Ð°Ñ‡Ð°Ð» ÑÐ²Ð¾ÑŽ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ
while (true) {
  if (!isCallStackEmpty) {
    continue;
  }

  for (const task of eventLoop.microtasks) {
    task.execute();
  }
  eventLoop.microtasks = [];

  const task = eventLoop.nextMacrotask();
  if (task) {
    task.execute();
  }

  if (eventLoop.needRender()) {
    eventLoop.render();
  }
}
```

Ð¡Ð°Ð¼Ð¾Ðµ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ð¾Ðµ Ð² Ð´Ð°Ð½Ð½Ð¾Ð¼ ÐºÐ¾Ð´Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð²Ð½Ð¸Ð·Ñƒ, Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ñ†Ð¸ÐºÐ»Ð° `while`:

```typescript
// Event loop Ð½Ð°Ñ‡Ð°Ð» ÑÐ²Ð¾ÑŽ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ
while (true) {
  if (!isCallStackEmpty) {
    continue;
  }

  for (const task of eventLoop.microtasks) {
    task.execute();
  }
  eventLoop.microtasks = [];

  const task = eventLoop.nextMacrotask();
  if (task) {
    task.execute();
  }

  if (eventLoop.needRender()) {
    eventLoop.render();
  }
}
```

ÐœÑ‹ Ð¼Ð¾Ð¶ÐµÐ¼ Ð½Ð°Ð³Ð»ÑÐ´Ð½Ð¾ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ ÐºÐ°Ðº Event Loop Ð´ÐµÐ»Ð°ÐµÑ‚ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð¾ Ñ‚Ð¾Ð¼ ÐºÐ°ÐºÑƒÑŽ Ð·Ð°Ð´Ð°Ñ‡Ñƒ Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ Ð¿ÐµÑ€Ð²Ð¾Ð¹.

1. Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Event Loop Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð¸ÑÑŒ Ð»Ð¸ Ð²ÑÐµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸
2. ÐŸÐ¾Ñ‚Ð¾Ð¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑŽÑ‚ÑÑ **Ð²ÑÐµ Ð·Ð°Ð´Ð°Ñ‡Ð¸** Ð¸Ð· Ð¼Ð¸ÐºÑ€Ð¾Ñ‚Ð°ÑÐºÐ¾Ð²
3. ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… Ð¼Ð¸ÐºÑ€Ð¾Ñ‚Ð°ÑÐºÐ¾Ð² - Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÑ‚ÑÑ
4. Ð—Ð°Ñ‚ÐµÐ¼ Ð¼Ñ‹ Ð±ÐµÑ€ÐµÐ¼ **Ð¾Ð´Ð½Ñƒ** Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ñƒ Ð¸Ð· ÑÐ¿Ð¸ÑÐºÐ° Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÐ¼ ÐµÐµ
5. ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¼Ñ‹ ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½ÑƒÐ¶Ð½Ð¾ Ð»Ð¸ Ð½Ð°Ð¼ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ð¿ÐµÑ€ÐµÑ€Ð¸ÑÐ¾Ð²ÐºÑƒ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
6. Ð•ÑÐ»Ð¸ Ð¿ÐµÑ€ÐµÑ€Ð¸ÑÐ¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð½ÑƒÐ¶Ð½Ð¾ - Ð´ÐµÐ»Ð°ÐµÐ¼ ÑÑ‚Ð¾
7. Ð’ÑÐµ ÑÐ½Ð¾Ð²Ð° Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ñ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ð¿ÑƒÐ½ÐºÑ‚Ð° :)

# Ð­ÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ñ‹ âœ¨
Ð’ÐµÑÑŒ ÑÑ‚Ð¾Ñ‚ Ñ„Ð»Ð¾Ñƒ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð»ÐµÐ³ÐºÐ¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ. Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð²Ð¾Ð·ÑŒÐ¼ÐµÐ¼ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¼Ð¸ÐºÑ€Ð¾ Ð¸ Ð¼Ð°ÐºÑ€Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹ Ð¸ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐµÐ¼ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð¸Ñ…

```js
console.log("Step 1: In global scope")

setTimeout(() => console.log("Step 2: In setTimeout"));

new Promise((resolve) => {
  console.log('Step 3: In promise constructor');
}).then(() => console.log('Step 4: In then'));

setTimeout(() => console.log("Step 5: In another setTimeout"))
```

```output
Step 1: In global scope
Step 3: In promise constructor
Step 4: In then
Step 2: In setTimeout
Step 5: In another setTimeout
```

> ÐÐ° Ð²ÑÑÐºÐ¸Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹ Ð½Ð°Ð¿Ð¾Ð¼Ð½ÑŽ, Ñ‡Ñ‚Ð¾ ÐºÐ¾Ð»Ð»Ð±ÑÐº Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐºÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€Ð° Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ° ÑÐ²Ð»ÑÐµÑ‚ÑÑ **ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼**.

ÐšÐ°Ðº Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ Ñ‚ÑƒÑ‚ Ð²ÑÐµ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ ÐºÐ¾Ð´Ñƒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ñ‹ Ñ€Ð°ÑÑÐ¼Ð°Ñ‚Ñ€Ð¸Ð²Ð°Ð»Ð¸ Ð²Ñ‹ÑˆÐµ.

- Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð¸ÑÑŒ Ð²ÑÐµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸: `Step 1`, `Step 3`;
- ÐŸÐ¾Ñ‚Ð¾Ð¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð¸ÑÑŒ Ð²ÑÐµ Ð¼Ð¸ÐºÑ€Ð¾Ñ‚Ð°ÑÐºÐ¸: `Step 4`;
- Ð—Ð°Ñ‚ÐµÐ¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð¸ÑÑŒ Ð²ÑÐµ Ð¼Ð°ÐºÑ€Ð¾Ñ‚Ð°ÑÐºÐ¸: `Step 2`, `Step 5`;

Ð¡Ð»ÐµÐ´ÑƒÐµÑ‚ Ð·Ð°Ð¼ÐµÑ‚Ð¸Ñ‚ÑŒ Ñ‡Ñ‚Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¸Ð· ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹ Ð¿Ð¾ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ñƒ FIFO (First In, First Out) (ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð²Ð¾ÑˆÐµÐ», Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð²Ñ‹ÑˆÐµÐ»),
Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð² ÑÐ¿Ð¸ÑÐºÐµ Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡ Ð²Ñ‹Ð²ÐµÐ»Ð¾ÑÑŒ `Step 2`, Ð° Ð·Ð°Ñ‚ÐµÐ¼ `Step 5`.

::ContentSvg{src="./assets/steps-1.svg" alt="Ð¨Ð°Ð³Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ"}
::

## Ð”Ð²Ð° then

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð´Ð¾Ð±Ð°Ð²Ð¸Ð¼ ÐµÑ‰Ðµ Ð¾Ð´Ð¸Ð½ `then` Ðº Ð½Ð°ÑˆÐµÐ¼Ñƒ Ð¿Ñ€Ð¾Ð¼Ð¸ÑÑƒ Ð¸ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ñ‡Ñ‚Ð¾ ÑÐ»ÑƒÑ‡Ð¸Ñ‚ÑÑ:

```js
console.log("Step 1: In global scope")

setTimeout(() => console.log("Step 2: In setTimeout"));

new Promise((resolve) => {
  console.log('Step 3: In promise constructor');
}).then(() => console.log('Step 4: In then'))
  .then(() => console.log('Step 5: In another then'));

setTimeout(() => console.log("Step 6: In another setTimeout"))

```

```output
Step 1: In global scope
Step 3: In promise constructor
Step 4: In then
Step 5: In another then
Step 2: In setTimeout
Step 6: In another setTimeout
```

ÐšÐ°Ðº Ð¼Ñ‹ Ð¼Ð¾Ð¶ÐµÐ¼ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ, Ð¾ÑÐ¾Ð±Ð¾ Ð½Ð¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð¿Ð¾Ð¼ÐµÐ½ÑÐ»Ð¾ÑÑŒ. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ð»Ð°ÑÑŒ ÐµÑ‰Ðµ Ð¾Ð´Ð½Ð° Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð°,
Ð² Ñ†ÐµÐ»Ð¾Ð¼ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ñ‹Ñ… ÑÑ‚Ñ€Ð¾Ðº Ð½Ð¸ÐºÐ°Ðº Ð½Ðµ Ð¿Ð¾Ð¼ÐµÐ½ÑÐ»ÑÑ, Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ð¾ÑÐ»Ðµ `Step 4` Ð´Ð¾Ð±Ð°Ð²Ð¸Ð»ÑÑ `Step 5`.

::ContentSvg{src="./assets/steps-2.svg" alt="Ð¨Ð°Ð³Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ"}
::

## Ð”Ð²Ð° Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ° Ñ Ð´Ð²ÑƒÐ¼Ñ then

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐµÐ¼ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ñ‚Ð¾ Ð¶Ðµ, Ð½Ð¾ ÑƒÐ¶Ðµ Ñ Ð´Ð²ÑƒÐ¼Ñ Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ°Ð¼Ð¸:

```js
console.log("Step 1: In global scope")

setTimeout(() => console.log("Step 2: In setTimeout"));

new Promise((resolve) => {
  console.log('Step 3: In promise constructor');
  resolve();
}).then(() => console.log('Step 4: In then'))
  .then(() => console.log('Step 5: In another then'));

setTimeout(() => console.log("Step 6: In another setTimeout"))

new Promise((resolve) => {
  console.log('Step 7: In promise constructor');
  resolve();
}).then(() => console.log('Step 8: In then'))
  .then(() => console.log('Step 9: In another then'));
```

```output
Step 1: In global scope
Step 3: In promise constructor
Step 7: In promise constructor
Step 4: In then
Step 8: In then
Step 5: In another then
Step 9: In another then
Step 2: In setTimeout
Step 6: In another setTimeout
```

Ð¢ÑƒÑ‚ ÑƒÐ¶Ðµ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð¿Ð¾ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½ÐµÐµ, Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ñ€Ð°Ð·Ð±Ð¸Ñ€Ð°Ñ‚ÑŒÑÑ. Ð’ÑÐµ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»Ð¸ÑÑŒ Ð¿ÐµÑ€Ð²Ñ‹Ð¼Ð¸. Ð—Ð°Ñ‚ÐµÐ¼ Ð¿Ð¾Ð´Ñ‚ÑÐ½ÑƒÐ»Ð¸ÑÑŒ Ð¼Ð¸ÐºÑ€Ð¾Ñ‚Ð°ÑÐºÐ¸, Ð½Ð¾ Ð½Ðµ Ð² Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð¼ Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ:
Ð²Ð¼ÐµÑÑ‚Ð¾ Ñ‚Ð¾Ð³Ð¾ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ `console.log` Ð² Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ `Step 4`, `Step 5`, `Step 8`, `Step 9`, Ð¾Ð½ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð»ÑÑ Ð² Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸
`Step 4`, `Step 8`, `Step 5`, `Step 9`. Ð¡ÐµÐ¹Ñ‡Ð°Ñ Ñ€Ð°Ð·Ð±ÐµÑ€ÐµÐ¼ÑÑ Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ñ‚Ð°Ðº ÑÐ»ÑƒÑ‡Ð¸Ð»Ð¾ÑÑŒ.

::ContentSvg{src="./assets/steps-3-1.svg" alt="Ð Ð°Ð·Ð½Ð¸Ñ†Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ"}
::

Ð”ÐµÐ»Ð¾ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ‚Ð¾Ñ€ JavaScript Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ ÐºÐ¾Ð´ ÑˆÐ°Ð³ Ð·Ð° ÑˆÐ°Ð³Ð¾Ð¼. ÐžÐ½ ÑƒÐ²Ð¸Ð´ÐµÐ» Ñ‡Ñ‚Ð¾ Ñƒ Ð½Ð°Ñ ÐµÑÑ‚ÑŒ `then` Ð¸ Ð¿Ð¾Ð¼ÐµÑÑ‚Ð¸Ð» Ð¸Ñ… Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡,
ÐºÐ¾Ð³Ð´Ð° Ð¿Ñ€Ð¸ÑˆÐ»Ð° Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¾Ñ‚Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð¸ - Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ‚Ð¾Ñ€ ÑƒÐ²Ð¸Ð´ÐµÐ» ÐµÑ‰Ðµ Ð¾Ð´Ð¸Ð½ `then` Ð¸ Ð¾Ð¿ÑÑ‚ÑŒ Ð¿Ð¾Ð¼ÐµÑÑ‚Ð¸Ð» ÐµÐ³Ð¾ Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡. Ð¢Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼ Ð²ÑÐµ `then`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð±Ñ‹Ð»Ð¸ Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ñ… `then`
Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐ»Ð¸ÑÑŒ Ð² Ñ€ÑÐ´ Ð¿Ð¾ÑÐ»Ðµ Ñ‚Ð¾Ð³Ð¾ ÐºÐ°Ðº Ð¿ÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹Ðµ `then` Ð¾Ñ‚Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð¸.

::ContentSvg{src="./assets/steps-3-2.svg" alt="Ð”ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡"}
::

## ÐœÐ¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð°, Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð°
Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð¿Ñ€Ð¾Ð¼Ð¸Ñ, Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¾Ð±ÑŠÑÐ²Ð»ÑÑ‚ÑŒÑÑ Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð°. Ð¡Ð´ÐµÐ»Ð°ÐµÐ¼ ÑÑ‚Ð¾ Ð¾Ð¿ÑÑ‚ÑŒ Ð¶Ðµ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ¾Ð²:

```js
setTimeout(() => console.log('Step 1: In setTimeout'));

new Promise(resolve => {
  console.log('Step 2: In promise constructor');
  resolve();
}).then(() => {
  console.log('Step 3: In then');
  setTimeout(() => console.log('Step 4: In setTimeout (inside of "then")'));
});

setTimeout(() => console.log('Step 5: In another setTimeout'));
```

```output
Step 2: In promise constructor
Step 3: In then
Step 1: In setTimeout
Step 5: In another setTimeout
Step 4: In setTimeout (inside of "then")
```

Ð¢ÑƒÑ‚ Ð²ÑÐµ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ñ‚Ñ€Ð¸Ð²Ð¸Ð°Ð»ÑŒÐ½Ð¾. Ð’Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¾Ð´Ð½Ð¾Ð¹ Ð¸Ð· Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡ Ð±Ñ‹Ð»Ð° Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð°.
Ð­Ñ‚Ð° Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð° Ð±Ñ‹Ð»Ð° Ð¿Ð¾Ð¼ÐµÑ‰ÐµÐ½Ð° Ð² ÐºÐ¾Ð½ÐµÑ† Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ Ð¼Ð°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡. ÐŸÐ¾ÑÑ‚Ð¾Ð¼Ñƒ `Step 4` Ð²Ñ‹Ð²ÐµÐ»ÑÑ Ð² ÐºÐ¾Ð½Ñ†Ðµ (Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð´Ð°Ð½Ð½Ð°Ñ Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð° Ð±Ñ‹Ð»Ð° Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð° Ð¿Ð¾Ð·Ð¶Ðµ Ð²ÑÐµÑ…).

## ÐœÐ°ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð° Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¼Ð¸ÐºÑ€Ð¾Ð·Ð°Ð´Ð°Ñ‡Ð°

```js
setTimeout(() => console.log('Step 1: In setTimeout'));
setTimeout(() => {
  new Promise(resolve => {
    console.log('Step 2: In promise constructor (inside setTimeout)');
    resolve();
  }).then(() => console.log('Step 3: In then (inside setTimeout)'));
});

new Promise(resolve => {
  console.log('Step 4: In promise constructor');
  resolve();
}).then(() => {
  console.log('Step 5: In then');
});

setTimeout(() => console.log('Step 6: In another setTimeout'));
```

```output
Step 4: In promise constructor
Step 5: In then
Step 1: In setTimeout
Step 2: In promise constructor (inside setTimeout)
Step 3: In then (inside setTimeout)
Step 6: In another setTimeout
```

