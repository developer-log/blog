---
title: CSR, SSR, SSG, ISR и другие аббревиатуры
tags:
  - backend
  - frontend
  - pattern
date: 16 Sep 2023
references:
  - name: What is the difference between SSR, ISR, CSR, SSG
    url: https://dev.to/mojodev/what-is-the-difference-between-ssr-isr-csr-ssg-2g9p
  - name: CSR, SSG, SSR — про рендеринг приложений на примерах
    url: https://habr.com/ru/companies/alfa/articles/725626/
  - name: "Rendering strategies: CSR, SSR, SSG, ISR"
    url: https://dev.to/sjsouvik/rendering-strategies-csr-ssr-ssg-isr-4c5k
  - name: "Patterns.dev - Rendering Patters: Introduction"
    url: https://www.patterns.dev/posts/rendering-patterns
---

Для каждого разработчика важно понимать как оптимизировать его проект. В веб-технологиях придумали несколько
паттернов, с помощью которых можно оптимизировать рендеринг приложения. Сегодня рассмотрим этим паттерны,
поговорим почему это важно и зачем это нужно.

# Почему мы вообще должны об этом думать?
Мы живем во время живого веба, если раньше потребность в быстродействии и удобности в приложенях внутри браузера
была не так велика, то сегодня быстродействие и удобность актуальна как никогда раньше.

[Чем быстрее работает приложение, тем больше выручки](https://developer.mozilla.org/en-US/docs/Learn/Performance/why_web_performance) можно получить.
Если даже не брать выручку в расчет, то вряд ли кто-то будет пользоваться приложением, которое будет грузиться 30 секунд.

Для того чтобы эффективно измерять производительность приложений инженеры придумали Web Vitals.

::ContentBookmark{url="https://web.dev/vitals/"}
::

На момент 2020-го года измерялось три показателя:

- **Задержка перед первой отрисовкой (LCP - Largest Contentful Paint)**: Измеряет производительность загрузки приложения;
- **Задержка для первого взаимодействия (FID - First Input Delay)**: Измеряет интерактивность веб-приложения;
- **Совокупный сдвиг макета (CLS - Cumulative Layout Shift)**: Измеряет стабильность интерфейса;

Для каждой метрики есть свои показатели.

## LCP
LCP основывается на том, когда был отрендерен самый большой элемент на веб-странице.
Обычно рендеринг больших элементов ставится в первую очередь, для того чтобы показать
как можно больше контента пользователю. Первым большим элементом может быть большой блок текста, картинка или
видео.

::ContentSvg{src="./assets/wv-lcp.svg"}
::

## FID
FID это показатель времени, который указывает на то, сколько занимает времени обработать первое взаимодействие пользователя
с приложением.

::ContentSvg{src="./assets/wv-fid.svg"}
::


## CLS
CLS это показатель сдвига элементов на странице. Если у приложения есть огромный скрипт, который долго грузится, а после загрузки
дополняет DOM-дерево какими-то элементами в результате чего все на странице сдвигается - это плохо.

Данный показатель измеряется не по временной шкале, а по шкале перцентилей. Данная шкала измеряется следующей формулой:

```text
Оценка смещения макета = доля воздействия * доля расстояния
```

Если вы более подробно хотите разобраться в том что такое "доля воздействия" и "доля расстояния", то вы можете
ознакомиться с данными понятиями на странице CLS в web.dev

::ContentBookmark{url="https://web.dev/cls/"}
::

Оптимальные значения для CLS следующие:

::ContentSvg{src="./assets/wv-cls.svg"}
::

## Дополнительно
Показателей Web Vitals (кроме трех упомянутых) достаточно много. Все они созданы для того чтобы эффективно измерять производительность приложения.
Вот краткая памятка по ним:

::ContentSvg{src="./assets/wv-extra.svg"}
::

# Client-side Rendering
Делали ли вы когда-то приложения на Vue/React/Svelte/Angular? Если да, то вы 100% использовали
Client-side rendering (*далее просто CSR*), даже не зная о нем.

Вы наверняка видели `index.html`, у которого в `<body>` только один элемент: `<div id="root"></div>`.
Все содержимое внутри `#root` будет наполняться с помощью JavaScript, это и есть CSR.

По сути CSR это паттерн, когда все компоненты в приложении рендерятся посредством JavaScript.
Если отключить JavaScript в браузере, то браузер выведет просто белое полотно, так как ничего не зарендерится.

Client-side rendering содержит слово *client* потому что вся отрисовка происходит на стороне клиента, а если быть точнее - браузера.

::ContentSvg{src="./assets/csr.svg"}
::

CSR подарил нам гибкость в приложениях, ибо всеми компонентами которые рендерятся на странице можно управлять посредством JavaScript.

Однако, он отнял у нас SEO и подарил плохие показатели FCP (время нужное для первой отрисовки) и TTI (время, которое нужно для первого взаимодействия), ведь для того чтобы отрендерить первый видимый блок
на странице браузер должен загрузить весь JavaScript и выполнить его.

::ContentSvg{src="./assets/csr-network.svg"}
::

Индексация таких сайтов также страдает, так как для того чтобы проиндексировать все содержимое сайта нужно запустить JavaScript.
Не все парсеры умеют это делать, а даже если и умеют то с SEO там приходится не сладко.

::ContentSvg{src="./assets/csr-index.svg"}
::

# Server-side Rendering
Если вы когда-то работали с Nuxt/Next/SvelteKit, то этот паттерн вам тоже знаком.

Server-side rendering (*далее SSR*) предполагает, что часть верстки рендерится на сервере
и отдается клиенту, реактивные состояния у клиента и сервера могут быть связаны и передаваться с помощью POST или GET запросов,
а обновление интерфейса идет как на сервере, так и на клиенте (такое обновление называется гидрация, об этом подробнее позже).

::ContentSvg{src="./assets/ssr.svg"}
::

У приложений с SSR более высокие показатели FCP и TTI, однако хромает TTFB (время затраченное на получение первого байта).
TTFB хромает из-за рендеринга на сервере, ведь теперь сервер не отдает заранее готовый контент, а динамически генерирует его
при каждом запрос `GET /`.

::ContentSvg{src="./assets/ssr-network.svg"}
::

## Гидрация
Гидрация это механизм разворачивания такого же приложения как на сервере, но уже на клиентской части.
Проблема SSR без гидрации состоит в том, что сервер отдает только HTML + CSS, но для того чтобы обратывать действия пользователя
нам нужен такой же фреймворк, как и на сервере.

::ContentBookmark{url="https://vuejs.org/guide/scaling-up/ssr.html#client-hydration"}
::

::ContentSvg{src="./assets/ssr-hydration.svg"}
::

# Static Site Generator

# Incremental Static Regeneration
